/* autogenerated by Processing revision 1292 on 2023-03-04 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class Fractal extends PApplet {

int WindowSizeX = 1920;
int WindowSizeY = 1080;
int BgColor = color(255, 255, 255);

float initialradius = 1000;
float radius = initialradius;
float radius_step = 2;
int n_points = 5;
int rep = 50;
PVector[] poly;

int[] _colors;

public int[] init_colors(int rep){
  int[] _colors = new int[rep];

  int _color1 = color(0xFFF6E1C3);
  int _color2 = color(0xFFE9A178);
  int _color3 = color(0xFFA84448);
  int _color4 = color(0xFF7A3E65);
  int[] colors_set = {_color1, _color2, _color3, _color4};

  for (int i = 0; i < rep; i += 1) {
    _colors[i] = colors_set[i%colors_set.length];
  }

  return _colors;

}

public PVector[] init_polygon(float radius, int n_points) {
  float angle = TWO_PI / n_points;
  PVector[] poly = new PVector[n_points];

  for (int i = 0; i < n_points; i += 1) {
    float a = angle * i;
    float sx = cos(a) * radius;
    float sy = sin(a) * radius;
    poly[i] = new PVector(sx, sy);
  }

  return poly;
}

public PVector[] init_subpolygon(PVector[] poly){
  PVector[] subpolygon = new PVector[poly.length];

  for (int i = 0; i < subpolygon.length-1; ++i) {
    subpolygon[i] = PVector.add(poly[i], poly[i+1]);
    subpolygon[i] = PVector.mult(subpolygon[i], 0.5f);
  }
  
  subpolygon[subpolygon.length-1] = PVector.add(poly[0], poly[poly.length-1]);
  subpolygon[subpolygon.length-1] = PVector.mult(subpolygon[subpolygon.length-1], 0.5f);

  return subpolygon;
}

public void draw_polygon(PVector[] poly, int _color){
  beginShape();
  for (int i = 0; i < poly.length; i += 1) {
    fill(_color);
    vertex(poly[i].x, poly[i].y);
  }
  endShape(CLOSE);
}

public void settings() {
  size(WindowSizeX, WindowSizeY);
}

public void setup() {
  frameRate(60);
  strokeWeight(2);
  _colors = init_colors(rep);
}

public void draw() {
  background(_colors[_colors.length -1]);

  poly = init_polygon(radius, n_points);
  for (int i = 0; i < rep; i+=1){
    pushMatrix();
    translate(WindowSizeX/2, WindowSizeY/2);
    draw_polygon(poly, _colors[i]);
    popMatrix();

    poly = init_subpolygon(poly);
  }

  radius += radius_step;

  if (radius > max(WindowSizeX, WindowSizeY)) {
    radius = initialradius;
  }
  
}


  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "Fractal" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
